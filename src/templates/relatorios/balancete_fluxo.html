{% extends "layout.html" %}
{% block title %}Balancete de Fluxo de Caixa{% endblock %}
{% block content %}
<form method="GET" class="mb-4">
    <div class="row g-2 align-items-end">
        <div class="col-auto">
            <label class="form-label">Data Inicial</label>
            <input type="date" name="data_inicio" class="form-control" value="{{ data_inicio }}">
        </div>
        <div class="col-auto">
            <label class="form-label">Data Final</label>
            <input type="date" name="data_fim" class="form-control" value="{{ data_fim }}">
        </div>
        <div class="col-auto">
            <label class="form-label">Tipo de Relatório</label>
            <select name="tipo_relatorio" class="form-select">
                <option value="sintetico" {% if tipo_relatorio == 'sintetico' %}selected{% endif %}>Sintético</option>
                <option value="analitico" {% if tipo_relatorio == 'analitico' %}selected{% endif %}>Analítico</option>
                <option value="comparativo" {% if tipo_relatorio == 'comparativo' %}selected{% endif %}>Comparativo</option>
            </select>
        </div>
        <div class="col-auto">
            <label class="form-label">Origem dos Dados</label>
            <select name="origem_dados" class="form-select">
                <option value="realizado" {% if origem_dados == 'realizado' %}selected{% endif %}>Realizado</option>
                <option value="previsto" {% if origem_dados == 'previsto' %}selected{% endif %}>Previsto</option>
                <option value="comparativo" {% if origem_dados == 'comparativo' %}selected{% endif %}>Comparativo</option>
            </select>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Filtrar</button>
        </div>
        <div class="col-auto">
            <a href="{{ url_for('relatorios.export_balancete_fluxo', data_inicio=data_inicio, data_fim=data_fim) }}" class="btn btn-success">
                <i class="fas fa-file-excel"></i> Exportar Excel
            </a>
        </div>
    </div>
</form>
<div class="ls-card p-4 mb-4">
    <h2 class="fw-bold mb-3">Balancete Sintético</h2>
    <table class="table table-hover mb-4">
        <thead>
            <tr>
                <th>Conta</th>
                <th>Descrição</th>
                <th class="text-end">Saldo Anterior</th>
                <th class="text-end">Débito</th>
                <th class="text-end">Crédito</th>
                <th class="text-end">Saldo</th>
            </tr>
        </thead>
        <tbody>
            {% for row in estrutura_contas %}
            <tr>
                <td style="padding-left: {{ row.nivel * 20 }}px">{{ row.codigo }}</td>
                <td>{{ row.descricao }}</td>
                <td class="text-end">R$ {{ row.saldo_anterior|brl }}</td>
                <td class="text-end" style="color: #ef4444;">R$ {{ row.debito|brl }}</td>
                <td class="text-end" style="color: #22c55e;">R$ {{ row.credito|brl }}</td>
                <td class="text-end fw-bold">R$ {{ row.saldo_final|brl }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
